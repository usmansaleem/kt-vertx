buildscript {
    ext.vertx_version = '3.4.2'

    repositories {
        jcenter()
    }
}

plugins {
    id "org.jetbrains.kotlin.jvm" version "1.1.50"
    id 'application'
    id 'java'
    id 'com.github.johnrengelman.shadow' version '2.0.1'
}

sourceCompatibility = '1.8'
version = '1.0.0'

mainClassName = 'io.vertx.core.Launcher'
def mainVerticleName = 'info.usmans.blog.vertx.ServerVerticle'

repositories {
    jcenter()
    maven {
        url "https://oss.sonatype.org/content/repositories/iovertx-3684/"
    }
}

dependencies {
    compile "io.vertx:vertx-core:$vertx_version"
    compile "io.vertx:vertx-web:$vertx_version"

    compile "org.jetbrains.kotlin:kotlin-stdlib-jre8"
    compile "org.jetbrains.kotlin:kotlin-runtime"

    testCompile "org.jetbrains.kotlin:kotlin-test"
    testCompile "org.jetbrains.kotlin:kotlin-test-junit"
}

compileKotlin {
    kotlinOptions.jvmTarget = 1.8
}

compileTestKotlin {
    kotlinOptions.jvmTarget = 1.8
}

// Naming and packaging settings for the "shadow jar".
shadowJar {
    baseName = 'uzi-vertx'
    classifier = 'shadow'
    version=null

    manifest {
        attributes 'Main-Verticle': mainVerticleName
    }
    mergeServiceFiles {
        include 'META-INF/services/io.vertx.core.spi.VerticleFactory'
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = '4.2'
}

